attackerLocated(internet).
attackGoal(execCode(workStation2,_)).

hacl(internet, fireWall, {{Fire_Transport}}, {{Fire_Port}}).
hacl(fireWall, webServer, _, _).
hacl(webServer, fileServer, _, _).
hacl(fileServer, webServer, _, _).
hacl(webServer, mailServer, _, _).
hacl(fileServer, workStation3, _, _).


/* configuration information of webServer */
vulExists(webServer, '{{CVE_Id_Web}}', {{Web_Module}}).
vulProperty('{{CVE_Id_Web}}', remoteExploit, privEscalation).
networkServiceInfo(webServer, {{Web_Module}}, {{Web_Transport}}, {{Web_Port}}, '{{Web_Product}}').

/* configuration information of workStation3 */
nfsMounted(workStation2, '/usr/local/share', fileServer, '/export', read).


/* configuration information of fiewWall */
vulExists(fireWall, '{{CVE_Id_Fire}}', {{Fire_Module}}).
vulProperty('{{CVE_Id_Fire}}', remoteExploit, privEscalation).
networkServiceInfo(fireWall, {{Fire_Module}}, {{Fire_Transport}}, {{Fire_Port}}, '{{Fire_Product}}').


/* configuration information of fileServer */
networkServiceInfo(fileServer, {{File_Module}}, {{File_Transport}}, {{File_Port}}, root).
nfsExportInfo(fileServer, '/export', _anyAccess, workStation).
nfsExportInfo(fileServer, '/export', _anyAccess, webServer).
vulExists(fileServer, '{{CVE_Id_File}}', {{File_Module}}).
vulProperty('{{CVE_Id_File}}', remoteExploit, privEscalation).
localFileProtection(fileServer, root, _, _).
